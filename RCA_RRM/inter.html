<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="fr">
<head>
	
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" name="viewport">
    <title>RRM RCA - Intervention</title>
	
	
	<script type="text/javascript" src="js/RRM_RCA_area_intervention.js"></script>
	<script type="text/javascript" src="js/RRM_RCA_admin1.js"></script>

    <!-- Bootstrap -->
	
	<script src="js/html5.js"></script>
	<link type="text/css" rel="stylesheet" href="css/bootstrap.css">
    <link type="text/css" href="css/leaflet.css" rel="stylesheet"/>
    <link type="text/css" href="css/leaflet.markercluster.css" rel="stylesheet"/>
    <link rel="stylesheet" type="text/css" href="css/dc.css">
     <!--Add IntroJs styles  -->
    <link rel="stylesheet" type="text/css" href="css/introjs.css">
    <link rel="stylesheet" type="text/css" href="css/dashboard.css">
    <link rel="stylesheet" type="text/css" href="css/colorbrewer.css">

    <link href="font-awesome-4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
	

<style>
/* Change the styles below in order to customize your template */

body{font-family: Helvetica, Arial; font-weight: regular; font-size: 15px; color: #555; background-color: #FFF; margin: 0;}
h1{font-weight: bold; font-size: 31px; letter-spacing: -1px; color: #333; line-height: 33px;}
h3{font-weight: bold; font-size: 20px; color: #fff; text-transform: uppercase; margin: 5px 0 0 0;}
h3a{font-weight: bold; font-size: 12px; color: #fff;  margin: 20px 0 0 0;}
h4a {   color:#505050; font-size: 12px; margin: 5px 0 0 0;}
h4{font-weight: bold; font-size: 12px; color: #000; margin: 10px 0 0 10px;line-height:14px}
h5{font-size: 10px;font-style:italic; color: #000; margin: 0px 0px 0px 10px; line-height:10px}
p{margin: 8px 0 20px 0; line-height: 18px;}
a, a:visited{color: #397DB8; text-decoration: none;}
a:hover{text-decoration: underline;}

.wrapper{display: block; margin: 0px 0 0 0; padding: 4px 30px 0 30px;}

.map{background-color:#eee; position: absolute; top: 50px; left: 0; bottom: 0; width: 50%; *height:100%;}
.sidepanel{background-color:#b6b6b6; position: absolute; top: 50px; right: 0;  bottom: 0; width: 50%; *height: 100%; overflow: auto}

.context{font-family: Helvetica, Arial; font-size: 13px; color: #999; padding: 10px 0 0 0;}
.subheader{border-bottom: 1px solid #ddd;}
.footer{border-top: 1px solid #ddd; margin-top: 30px;}
.titleBlock{text-align: right;
/* Here are the styles that makes the template responsive*/
@media only screen and (max-width: 768px) {
  .map{position: inherit; height: 400px; width: 100%; display: block;}
  .sidepanel{position: inherit; width: 100%;}
}
@media only screen and (max-width: 480px) {
  .map {height: 300px;}
}
.bar rect {
  shape-rendering: crispEdges;
}
.bar text {
  text-anchor: end;
}
.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}
</style>
<style type="text/css">
			
			.axis path,
			.axis line {
				fill: none;
				stroke: black;
				shape-rendering: crispEdges;
			}
			
			.axis text {
				font-family: sans-serif;
				font-size: 11px;
			}

		</style>	
</head>
 <body>
  <nav class="navbar navbar-inverse navbar-static-top">
        <div class="container">
			<div class="navbar-header">
			  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			  </button>
			  <a class="navbar-brand" href="index.html">RRM République Centrafricaine</a>
			</div>
			<div id="navbar" class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<li class="dropdown">
					  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Type d'activités<span class="caret"></span></a>
					  
						<ul class="dropdown-menu" role="menu">
							<li><a href="alerte.html">Alertes</a></li>
							<li><a href="mex.html">MEX (Missions Exploratoires)</a></li>
							<li><a href="MSA.html">MSA (Evaluations Multisectorielles)</a></li>
							<!--<li><a href="inter.html">Interventions</a></li>-->
							<li><a href="pdm.html">PDM</a></li>
							<!--<li><a href="acceshum.html">Accès humanitaire</a></li>
							<li><a href="plaidoyer.html">Plaidoyer</a></li>-->
							<li><a href="reference_2014.html">Carte de référence 2014</a></li>
							<li><a href="reference_2015.html">Carte de référence 2015</a></li>
							<li><a href="reference_2016.html">Carte de référence 2016</a></li>
							<li><a href="reference_2017.html">Carte de référence 2017</a></li>
						</ul>
					</li>
					<li><a href="index.html">Acceuil</a></li>
					<li><a class="reset" id="reset" href="#"><button>Réinitialiser</button></a></li>
				</ul>
				<ul class="nav navbar-nav navbar-right">
					<li style="top:12px"><img src="image/unicef-logo.png" width="125" height="25"style="border-width:0px;"></li>	
					<li><a> </a></li>
					<li style="top:7px"><img src="image/rrm.png" width="129" height="37"style="border-width:0px;"></li>	
					<li><a> </a></li>
					<li style="top:12px"><img src="image/REACH_logo.png" width="129" height="29"style="border-width:0px;"></li>					
				</ul>
			</div><!--/.nav-collapse -->
        </div>
    </nav>   
	
   <div style="display: block;"  id="dashboard">
             <div class="row" id="cccm">
                <div  class="map" id="cccm"  > </div>

                <div class="sidepanel">
					<div class="wrapper">
					
						<div class="row">
							<div  class="col-md-8">
							<h3>Interventions</h3>
							</div>
							<div  class="col-md-4" align="right">
							<h3a><br>Dernière actualisation: 19 juillet 2017</h3a>
							</div>
						</div>
						<div class="row">
							<div  class="col-md-12" align="justify">
							<h4a><br>Bienvenue sur la page du tableau de bord interactif RRM. Cliquez sur les différents éléments pour sélectionner les informations qui vous intéressent.<br> Pour revenir au début et réinitialiser les filtres, cliquez sur <b>« Réinitialiser »</b>. </h4a>
							</div>
						</div> 		
						 <div class="row">
							<div  class="col-md-2">
								<div  class="nombre" id="cccm" class="dc-chart"></div>
							</div>
						</div>
						<div class="row">
							<div  class="col-md-4">
								<div  class="inter" id="cccm" class="dc-chart"><h4>Nombre d'interventions </h4><h5>par préfecture</h5></div>
							</div>
							<div  class="col-md-4">
								<div  class="prefWASH" id="cccm" class="dc-chart"><h4>Nombre d'individus bénéficiaires WASH* </h4><h5>par préfecture (k = 1000)</h5></div>
							</div>
							<div  class="col-md-4">
								<div  class="prefNFI" id="cccm" class="dc-chart"><h4>Nombre d'individus bénéficiaires NFI**</h4><h5>par préfecture (k = 1000)</h5></div>
						</div>	
						 
						<div class="row">	
							<div  class="col-md-4">
								<div  class="year" id="cccm" class="dc-barChart">
								     <h4>Nombre d’interventions par an</h4>
								</div>
							</div>
							<div  class="col-md-4">
								<div  class="partner" id="cccm" class="pie-chart"><h4>Nombre d'interventions par organisation</h4></div>
							</div>
							<div  class="col-md-4">
								<div  class="intertype" id="cccm" class="pie-chart"><h4>Type d'intervention</h4></div>
							</div>
						</div>
						<div class="row">
							
							<div  class="col-md-4">
								
								<div  class="savon" id="cccm" class="dc-chart"><h4>NFI** distribués</h4></div>
								<div  class="couverture" id="cccm" class="dc-chart"></div>
								<div  class="moustiquaire" id="cccm" class="dc-chart"></div>
								<div  class="natte" id="cccm" class="dc-chart"></div>
								<div  class="bidon" id="cccm" class="dc-chart"></div>
								<div  class="bache" id="cccm" class="dc-chart"></div>
								<div  class="seau" id="cccm" class="dc-chart"></div>
								<div  class="kitcuis" id="cccm" class="dc-chart"></div>
								<div  class="seau" id="cccm" class="dc-chart"></div>
								<div  class="vetenf" id="cccm" class="dc-chart"></div>
								<div  class="torche" id="cccm" class="dc-chart"></div>
								<div  class="vetbebe" id="cccm" class="dc-chart"></div>				
							</div>
							<div  class="col-md-4">	
								<div  class="sensib" id="cccm" class="dc-chart"><h4>Activités WASH  </h4></div>
								<div  class="comgest" id="cccm" class="dc-chart"></div>
								<div  class="latbloc" id="cccm" class="dc-chart"></div>
								<div  class="lat" id="cccm" class="dc-chart"></div>
								<div  class="borehole" id="cccm" class="dc-chart"></div>
								<div  class="gestion" id="cccm" class="dc-chart"></div>
							</div>
							<div  class="col-md-4">
								
							
							</div>
							
						</div>  
						<!--<div class="row">	  
									<div  class="col-md-1">
									   
									</div>
									<div  class="col-md-4">
									   <div Class ="CauseIntNFI" id="cccm" class="dc-lineChart"><h4>Cause internes de délais Interventions NFI</h4><h5>Nombre de causes reportées</h5></div>
									</div>
									<div  class="col-md-2">
									   
									</div>
								
									<div  class="col-md-4">
									   <div Class ="CauseExtNFI" id="cccm" class="dc-lineChart"><h4>Causes externes de délais Interventions NFI</h4><h5>Nombre de causes reportées</h5></div>
									</div>
									<div  class="col-md-1">
									   
									</div>
						</div>	
						<div class="row">	  
									<div  class="col-md-1">
									   
									</div>
									<div  class="col-md-4">
									   <div Class ="CauseIntWASH" id="cccm" class="dc-lineChart"><h4>Cause internes de délais Interventions EAH</h4><h5>Nombre de causes reportées</h5></div>
									</div>
									<div  class="col-md-2">
									   
									</div>
								
									<div  class="col-md-4">
									   <div Class ="CauseExtWASH" id="cccm" class="dc-lineChart"><h4>Causes externes de délais Interventions EAH</h4><h5>Nombre de causes reportées</h5></div>
									</div>
									<div  class="col-md-1">
									   
									</div>
						</div>	-->
						
						<div class="row">
							<div  class="col-md-8">
							   <div Class ="start_dates" id="cccm" class="dc-lineChart">
								  <h4>Nombre d'interventions effectuées</h4><h5>Selectionner le graphique pour filtrer par date</h5>
								</div>
							</div>
							<!--<div  class="col-md-4">
								<div  class="year" id="cccm" class="dc-barChart">
								     <h4>Nombre d’interventions par an</h4>
								</div>
							</div>-->
						</div>
						<div class="row">
							<h5>*WASH: Eau, Hygiène et Assainissement; **NFI: Produits non-alimentaires</h5>	
							<h5>***CBS: Mélange maïs-soja; ****CG: Comité de gestion </h5>		</br></br>					
														
						</div>
					</div>
                </div>
            </div>
    </div>
      
   

    <script type="text/javascript" src="js/intro.js"></script>
    <script type="text/javascript" src="js/d3_002.js"></script>
    <script type="text/javascript" src="js/d3.js"></script>
    <script type="text/javascript" src="js/crossfilter.js"></script>
    <script type="text/javascript" src="js/dc.js"></script>
    <script type="text/javascript" src="js/jquery.js"></script>
<!--maps-->
    <script type="text/javascript" src="js/leaflet.js"></script>
	<script type="text/javascript"  src="js/esri-leaflet.js"></script>
    <script type="text/javascript" src="js/leaflet.markercluster.js"></script>
    <script type="text/javascript" src="js/dc.leaflet_inter.js"></script>
    <script type="text/javascript" src="js/colorbrewer.js"></script>

<script type="text/javascript">

/*     Markers      */

d3.csv("data/RRM_Interventions.csv", function(error,data) {
     //drawMarkerSelect(data);
	
     drawMarkerArea(data);
});


function regroup(dim, cols) {
    var _groupAll = dim.groupAll().reduce(
        function(p, v) { // add
            cols.forEach(function(c) {
                p[c] += v[c];
            });
            return p;
        },
        function(p, v) { // remove
            cols.forEach(function(c) {
                p[c] -= v[c];
            });
            return p;
        },
        function() { // init
            var p = {};
            cols.forEach(function(c) {
                p[c] = 0;
            });
            return p;
        });
    return {
        all: function() {
            // or _.pairs, anything to turn the object into an array
            return d3.map(_groupAll.value()).entries();
        }
    };
}

function drawMarkerArea(data) {
	var dateFormat = d3.time.format("%d.%m.%Y");
    data.forEach(function (d) {
	d.DD  = dateFormat.parse(d.endDate)
	//d.year = d3.time.year(d.DD)
	d.month= d3.time.month(d.DD)
	});

  var xf = crossfilter(data);
  var groupname = "marker-select";

  
   var facilities = xf.dimension(function(d) { return d.Latitude+","+d.Longitude; });
  var facilitiesGroup = facilities.group();
  
  dc.leafletMarkerChart(".map",groupname)
      .dimension(facilities)
      .group(facilitiesGroup)
      .width(900)
      //.height(300)
      .center([6.6,19.90])
      .zoom(6)
      .cluster(false)
      .renderPopup(true)
      .filterByArea(true)
      //.title(function (d) {return d.locationName + ": "+d.Individus_bénéficiaires_NFI_total+" individuals";})
    ;
  
		
		
		
		var PartnerDim = xf.dimension(function(d) { return d['Partner']; });
var Partnergp = PartnerDim.group().reduceCount();

  dc.rowChart("#cccm .partner",groupname)
        .dimension(PartnerDim)
        .group(Partnergp)
        .elasticX(true)
        .width(250)
        .height(200)
        .renderLabel(true)
        .ordering(function (p) { return -p.value;})
        .colors(['#FF6600'])
        .colorDomain([0,0])
        .colorAccessor(function(d, i){return 1;})
        .xAxis().ticks(4).tickFormat(d3.format(""));

		
	//********	
	var pref1 = xf.dimension(function(d) { return d.Code_Prefecture; });
	var nombre = pref1.group().reduceSum(function (d) { if (d.NFI_WASH == "NFI" )
			  return 1; else return 1; });
	 		  
	dc.rowChart("#cccm .nombre",groupname)
        .dimension(pref1)
        .group(nombre)
        .width(800)
		.height(40)
        .colors(['#FF6600'])
		.label(function(d) { return "Nombre total d'interventions: "+d.value; })
		.margins({top: 10, right: 5, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.2]));	 
			  
	//********		
		
  var interdim = xf.dimension(function(d) { 
			if (d.NFI_WASH == "NFI" )
			  return "NFI"  
			else if (d.NFI_WASH == "WASH" )
			  return "WASH"  
			else if (d.NFI_WASH == "NFI-WASH" )
			  return "NFI-WASH"	
			else
			  return "NFI-WASH"   			
			});   
  
  var intergp = interdim.group();  
  dc.rowChart("#cccm .intertype",groupname)
        .dimension(interdim)
        .group(intergp)
        .width(250)
        .height(200)
        .title(function (d) {return d.value+" interventions";})
		.colors(['#009933','#CC3333','#0066FF' ])
        .renderLabel(true)
		.xAxis().ticks(4).tickFormat(d3.format(""));
        ;
  
  var pref = xf.dimension(function(d) { return d.Code_Prefecture; });

  var natte = pref.group().reduceSum(function (d) { return d.NFI_nattes_total; });
  var bache = pref.group().reduceSum(function (d) { return d.NFI_baches_total; });
  var couverture = pref.group().reduceSum(function (d) { return d.NFI_couvertures_total; });
  var savon = pref.group().reduceSum(function (d) { return d.NFI_savons_total; });
  var bidon = pref.group().reduceSum(function (d) { return d.NFI_bidons_total; });
  var seau = pref.group().reduceSum(function (d) { return d.NFI_seau_total; });
  var kitcuis = pref.group().reduceSum(function (d) { return d.NFI_kitCuisine_total; });
  var vetenf = pref.group().reduceSum(function (d) { return d.NFI_vetements_enfants_total; });
  var vetbebe = pref.group().reduceSum(function (d) { return d.NFI_vetement_bebe; });
  var torche = pref.group().reduceSum(function (d) { return d.NFI_torche_total; });
  var moustiquaire = pref.group().reduceSum(function (d) { return d.NFI_moustiquaires_total; });

	
	dc.rowChart("#cccm .moustiquaire",groupname)
        .dimension(pref)
        .group(moustiquaire)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Moustiquaires: "+d.value+" unités"; })
		.margins({top: -0.2, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));  
	dc.rowChart("#cccm .seau",groupname)
        .dimension(pref)
        .group(seau)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Seaux: "+d.value+" unités"; })
		.margins({top: -0.2, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));  	
	dc.rowChart("#cccm .natte",groupname)
        .dimension(pref)
        .group(natte)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Natte: "+d.value+" unités"; })
		.margins({top: -0.2, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));  
	dc.rowChart("#cccm .bache",groupname)
        .dimension(pref)
        .group(bache)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Bâches: "+d.value+" unités"; })
		.margins({top: -1, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
    dc.rowChart("#cccm .couverture",groupname)
        .dimension(pref)
        .group(couverture)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Couverture: "+d.value+" unités"; })
		.margins({top: 0, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
	dc.rowChart("#cccm .savon",groupname)
        .dimension(pref)
        .group(savon)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Savons: "+d.value+" unités"; })
		.margins({top: 0, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
	dc.rowChart("#cccm .bidon",groupname)
        .dimension(pref)
        .group(bidon)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Bidons: "+d.value+" unités"; })
		.margins({top: 0, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
	dc.rowChart("#cccm .kitcuis",groupname)
        .dimension(pref)
        .group(kitcuis)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Kit cuisine: "+d.value+" kits"; })
		.margins({top: 0, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
	dc.rowChart("#cccm .vetenf",groupname)
        .dimension(pref)
        .group(vetenf)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Vêtements Enfant: "+d.value; })
		.margins({top: 0, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
	dc.rowChart("#cccm .vetbebe",groupname)
        .dimension(pref)
        .group(vetbebe)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Vêtements bébé: "+d.value; })
		.margins({top: 0, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
	dc.rowChart("#cccm .torche",groupname)
        .dimension(pref)
        .group(torche)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Torche: "+d.value+" unités"; })
		.margins({top: 0, right: 10, bottom: 0, left: 30})
		.x(d3.scale.linear().domain([0, 1000]))
		;
	 
   

  	   
  
  var sensib = pref.group().reduceSum(function (d) { return d.Sensibilisation_communaute_lavage_main; });
  var comgest = pref.group().reduceSum(function (d) { return d.comite_gestion_latrines; });
    dc.rowChart("#cccm .comgest",groupname)
        .dimension(pref)
        .group(comgest)
        .width(250)
        .height(40)
        .colors(['#3182bd'])
		.label(function(d) { return "Com. Gestion assainissement: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.4]));
 
	  dc.rowChart("#cccm .sensib",groupname)
        .dimension(pref)
        .group(sensib)
        .width(250)
        .height(40)
        .colors(['#3182bd'])
		.label(function(d) { return "Lavage des mains: "+d.value; })
		.margins({top: 5, right: 10, bottom: 0, left: 30})
		.x(d3.scale.linear().domain([0, 0.4]));

  var latbloc = pref.group().reduceSum(function (d) { return d.Nb_blocs_latrines; });
  var lat = pref.group().reduceSum(function (d) { return d.nb_latrines_installees; });
  	
	  dc.rowChart("#cccm .latbloc",groupname)
        .dimension(pref)
        .group(latbloc)
        .width(250)
        .height(40)
        .colors(['#3333FF'])
		.label(function(d) { return "Construction blocs  de latrines: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1]));
	  dc.rowChart("#cccm .lat",groupname)
        .dimension(pref)
        .group(lat)
        .width(250)
        .height(40)
        .colors(['#3333FF'])
		.label(function(d) { return "Construction de latrines: "+d.value; })
		.margins({top: 5, right: 10, bottom: 0, left: 30})
		.x(d3.scale.linear().domain([0, 1]));

	var borehole = pref.group().reduceSum(function (d) { return d.rehabilitation_forage_source_eau; });
	var gestion = pref.group().reduceSum(function (d) { return d.Redynamisation_comite_gestion_source_eau; });
    dc.rowChart("#cccm .borehole",groupname)
        .dimension(pref)
        .group(borehole)
        .width(250)
        .height(40)
        .colors(['#0099FF'])
		.label(function(d) { return "Réhabilitation forages: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.4]));
	 dc.rowChart("#cccm .gestion",groupname)
        .dimension(pref)
        .group(gestion)
        .width(250)
        .height(40)
        .colors(['#0099FF'])
		.label(function(d) { return "Formations Com. Gestion eau: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.4]));
  
	
	 var prefecture = xf.dimension(function(d) { return d.Prefecture; });
     var prefecturesect = prefecture.group().reduceCount();
  
	  dc.rowChart("#cccm .inter",groupname)
			.dimension(prefecture)
			.group(prefecturesect)
			.elasticX(true)
			.width(300)
			.height(300)
			.renderLabel(true)
			.colors(['#58585A'])
			.ordering(function (p) { return -p.value;})
			.colorDomain([0,0])
			.colorAccessor(function(d, i){return 1;})
			.xAxis().ticks(4).tickFormat(d3.format(""));
			
			// TOTAL_individus_beneficiaires
	
  var prefec = xf.dimension(function(d) { return d.Prefecture; });
  var pop_NFI = prefec.group().reduceSum(function (d) { return d.TOTAL_individus_beneficiaires_NFI; });
  var pop_WASH = prefec.group().reduceSum(function (d) { return d.TOTAL_individus_beneficiaires_WASH; });
  
  dc.rowChart("#cccm .prefWASH",groupname)
        .dimension(prefec)
        .group(pop_WASH)
		.elasticX(true)
        .width(300)
        .height(300)
		.elasticX(true)
        .renderLabel(true)
        .colors(['#3182bd'])
		.ordering(function (p) { return -p.value;})
        .xAxis().ticks(4).tickFormat(d3.format(""))
		
		;  
		
	dc.rowChart("#cccm .prefNFI",groupname)
        .dimension(prefec)
        .group(pop_NFI)
		.elasticX(true)
        .width(300)
        .height(300)
        .renderLabel(true)
		.ordering(function (p) { return -p.value;})
		.colors(["#31a354"])
        .xAxis().ticks(4).tickFormat(d3.format("s"));
		
		//***************
 

var yeargp  = xf.dimension(function(d) { return d.year; });
			
  var yeargroup = yeargp.group().reduceCount();

    dc.barChart("#cccm .year",groupname)
		.dimension(yeargp)
		.group(yeargroup)
		.width(300)
        .height(200)
		.x(d3.scale.ordinal().domain([2014,2015,2016,2017]))
		.xUnits(dc.units.ordinal)
		.transitionDuration(500)
		.centerBar(true)	
		.gap(30)  // 65 = norm
		.elasticY(true)
		.xAxisLabel('Année')
		.yAxisLabel('Nombre d’activités')
		.xAxis().tickFormat(function (d) {
        return d})
		;


var stdateDim = xf.dimension(function(d) {return d.month});
var stdategp = stdateDim.group();
var times = function(d) {return d.DD};

 dc.lineChart("#cccm .start_dates",groupname)
		.height(200)
		.width(700)
        .dimension(stdateDim)
		.group(stdategp)
		.x(d3.time.scale())
	    .round(d3.time.month.round)
	    .xUnits(d3.time.month)
	    .elasticY(true)
		.elasticX(true)
		.margins({top: 10, right: 10, bottom: 30, left: 30})
		.renderHorizontalGridLines(true)
		.renderArea(true)
		.dotRadius(8)
		
		.yAxisLabel('Nombre d’activités')
		.xAxis().ticks(12)
		;

$('#reset').on('click', function (){
  dc.filterAll(groupname);
  dc.redrawAll(groupname);
  return false;
})


  dc.renderAll(groupname);
}

</script>

 <script src="js/bootstrap.js"></script>
<!-- Custom Theme JavaScript -->
<script>
// Closes the sidebar menu
$("#menu-close").click(function(e) {
    e.preventDefault();
    $("#sidebar-wrapper").toggleClass("active");
});

// Opens the sidebar menu
$("#menu-toggle").click(function(e) {
    e.preventDefault();
    $("#sidebar-wrapper").toggleClass("active");
});

// Scrolls to the selected menu item on the page
$(function() {
    $('a[href*=#]:not([href=#])').click(function() {
        if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') || location.hostname == this.hostname) {

            var target = $(this.hash);
            target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
            if (target.length) {
                $('html,body').animate({
                    scrollTop: target.offset().top
                }, 1000);
                return false;
            }
        }
    });
});
</script>

</body>


</html>
=======
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="fr">
<head>
	
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" name="viewport">
    <title>RRM RCA - Intervention</title>
	
	<script type="text/javascript" src="js/RRM_RCA_area_intervention.js"></script>
	<script type="text/javascript" src="js/RRM_RCA_admin1.js"></script>

    <!-- Bootstrap -->
	
	<script src="js/html5.js"></script>
	<link type="text/css" rel="stylesheet" href="css/bootstrap.css">
    <link type="text/css" href="css/leaflet.css" rel="stylesheet"/>
    <link type="text/css" href="css/leaflet.markercluster.css" rel="stylesheet"/>
    <link rel="stylesheet" type="text/css" href="css/dc.css">
     <!--Add IntroJs styles  -->
    <link rel="stylesheet" type="text/css" href="css/introjs.css">
    <link rel="stylesheet" type="text/css" href="css/dashboard.css">
    <link rel="stylesheet" type="text/css" href="css/colorbrewer.css">

    <link href="font-awesome-4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
	

<style>
/* Change the styles below in order to customize your template */

body{font-family: Helvetica, Arial; font-weight: regular; font-size: 15px; color: #555; background-color: #FFF; margin: 0;}
h1{font-weight: bold; font-size: 31px; letter-spacing: -1px; color: #333; line-height: 33px;}
h3{font-weight: bold; font-size: 20px; color: #fff; text-transform: uppercase; margin: 5px 0 0 0;}
h3a{font-weight: bold; font-size: 12px; color: #fff;  margin: 20px 0 0 0;}
h4a {   color:#505050; font-size: 12px; margin: 5px 0 0 0;}
h4{font-weight: bold; font-size: 12px; color: #000; margin: 10px 0 0 10px;line-height:14px}
h5{font-size: 10px;font-style:italic; color: #000; margin: 0px 0px 0px 10px; line-height:10px}
p{margin: 8px 0 20px 0; line-height: 18px;}
a, a:visited{color: #397DB8; text-decoration: none;}
a:hover{text-decoration: underline;}

.wrapper{display: block; margin: 0px 0 0 0; padding: 4px 30px 0 30px;}

.map{background-color:#eee; position: absolute; top: 50px; left: 0; bottom: 0; width: 50%; *height:100%;}
.sidepanel{background-color:#b6b6b6; position: absolute; top: 50px; right: 0;  bottom: 0; width: 50%; *height: 100%; overflow: auto}

.context{font-family: Helvetica, Arial; font-size: 13px; color: #999; padding: 10px 0 0 0;}
.subheader{border-bottom: 1px solid #ddd;}
.footer{border-top: 1px solid #ddd; margin-top: 30px;}
.titleBlock{text-align: right;
/* Here are the styles that makes the template responsive*/
@media only screen and (max-width: 768px) {
  .map{position: inherit; height: 400px; width: 100%; display: block;}
  .sidepanel{position: inherit; width: 100%;}
}
@media only screen and (max-width: 480px) {
  .map {height: 300px;}
}
.bar rect {
  shape-rendering: crispEdges;
}
.bar text {
  text-anchor: end;
}
.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}
</style>
<style type="text/css">
			
			.axis path,
			.axis line {
				fill: none;
				stroke: black;
				shape-rendering: crispEdges;
			}
			
			.axis text {
				font-family: sans-serif;
				font-size: 11px;
			}

		</style>	
</head>
 <body>
  <nav class="navbar navbar-inverse navbar-static-top">
        <div class="container">
			<div class="navbar-header">
			  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			  </button>
			  <a class="navbar-brand" href="index.html">RRM République Centrafricaine</a>
			</div>
			<div id="navbar" class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<li class="dropdown">
					  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Type d'activités<span class="caret"></span></a>
					  
						<ul class="dropdown-menu" role="menu">
							 <li><a href="alerte.html">Alertes</a></li>
							<li><a href="mex.html">MEX (Missions Exploratoires)</a></li>
							<li><a href="MSA.html">MSA (Evaluations Multisectorielles)</a></li>
							<!--<li><a href="inter.html">Interventions</a></li>-->
							<li><a href="pdm.html">PDM</a></li>
							<!--<li><a href="acceshum.html">Accès humanitaire</a></li>
							<li><a href="plaidoyer.html">Plaidoyer</a></li>-->
							<li><a href="reference_2014.html">Carte de référence 2014</a></li>
							<li><a href="reference_2015.html">Carte de référence 2015</a></li>
							<li><a href="reference_2016.html">Carte de référence 2016</a></li>
							<li><a href="reference_2017.html">Carte de référence 2017</a></li>
					  </ul>
					</li>
					<li><a href="index.html">Acceuil</a></li>
					<li><a class="reset" id="reset" href="#"><button>Réinitialiser</button></a></li>
				</ul>
				<ul class="nav navbar-nav navbar-right">
					<li style="top:12px"><img src="image/unicef-logo.png" width="125" height="25"style="border-width:0px;"></li>	
					<li><a> </a></li>
					<li style="top:7px"><img src="image/rrm.png" width="129" height="37"style="border-width:0px;"></li>	
					<li><a> </a></li>
					<li style="top:12px"><img src="image/REACH_logo.png" width="129" height="29"style="border-width:0px;"></li>					
				</ul>
			</div><!--/.nav-collapse -->
        </div>
    </nav>   
	
   <div style="display: block;"  id="dashboard">
             <div class="row" id="cccm">
                <div  class="map" id="cccm"  > </div>

                <div class="sidepanel">
					<div class="wrapper">
					
						<div class="row">
							<div  class="col-md-8">
							<h3>Interventions</h3>
							</div>
							<div  class="col-md-4" align="right">
							<h3a><br>Dernière actualisation: 12 mai 2017</h3a>
							</div>
						</div>
						<div class="row">
							<div  class="col-md-12" align="justify">
							<h4a><br>Bienvenue sur la page du tableau de bord interactif RRM. Cliquez sur les différents éléments pour sélectionner les informations qui vous intéressent.<br> Pour revenir au début et réinitialiser les filtres, cliquez sur <b>« Réinitialiser »</b>. </h4a>
							</div>
						</div> 		
						 <div class="row">
							<div  class="col-md-2">
								<div  class="nombre" id="cccm" class="dc-chart"></div>
							</div>
						</div>
						<div class="row">
							<div  class="col-md-4">
								<div  class="inter" id="cccm" class="dc-chart"><h4>Nombre d'interventions </h4><h5>par préfecture</h5></div>
							</div>
							<div  class="col-md-4">
								<div  class="prefWASH" id="cccm" class="dc-chart"><h4>Nombre d'individus bénéficiaires WASH* </h4><h5>par préfecture (k = 1000)</h5></div>
							</div>
							<div  class="col-md-4">
								<div  class="prefNFI" id="cccm" class="dc-chart"><h4>Nombre d'individus bénéficiaires NFI**</h4><h5>par préfecture (k = 1000)</h5></div>
						</div>	
						 
						<div class="row">	
							<div  class="col-md-4">
								<div  class="year" id="cccm" class="dc-barChart">
								     <h4>Nombre d’interventions par an</h4>
								</div>
							</div>
							<div  class="col-md-4">
								<div  class="partner" id="cccm" class="pie-chart"><h4>Nombre d'interventions par organisation</h4></div>
							</div>
							<div  class="col-md-4">
								<div  class="intertype" id="cccm" class="pie-chart"><h4>Type d'intervention</h4></div>
							</div>
						</div>
						<div class="row">
							
							<div  class="col-md-4">
								
								<div  class="savon" id="cccm" class="dc-chart"><h4>NFI** distribués</h4></div>
								<div  class="couverture" id="cccm" class="dc-chart"></div>
								<div  class="moustiquaire" id="cccm" class="dc-chart"></div>
								<div  class="natte" id="cccm" class="dc-chart"></div>
								<div  class="bidon" id="cccm" class="dc-chart"></div>
								<div  class="bache" id="cccm" class="dc-chart"></div>
								<div  class="seau" id="cccm" class="dc-chart"></div>
								<div  class="kitcuis" id="cccm" class="dc-chart"></div>
								<div  class="seau" id="cccm" class="dc-chart"></div>
								<div  class="vetenf" id="cccm" class="dc-chart"></div>
								<div  class="torche" id="cccm" class="dc-chart"></div>
								<div  class="vetbebe" id="cccm" class="dc-chart"></div>				
							</div>
							<div  class="col-md-4">	
								<div  class="sensib" id="cccm" class="dc-chart"><h4>Activités WASH  </h4></div>
								<div  class="comgest" id="cccm" class="dc-chart"></div>
								<div  class="latbloc" id="cccm" class="dc-chart"></div>
								<div  class="lat" id="cccm" class="dc-chart"></div>
								<div  class="borehole" id="cccm" class="dc-chart"></div>
								<div  class="gestion" id="cccm" class="dc-chart"></div>
							</div>
							<div  class="col-md-4">
								
							
							</div>
							
						</div>  
						<!--<div class="row">	  
									<div  class="col-md-1">
									   
									</div>
									<div  class="col-md-4">
									   <div Class ="CauseIntNFI" id="cccm" class="dc-lineChart"><h4>Cause internes de délais Interventions NFI</h4><h5>Nombre de causes reportées</h5></div>
									</div>
									<div  class="col-md-2">
									   
									</div>
								
									<div  class="col-md-4">
									   <div Class ="CauseExtNFI" id="cccm" class="dc-lineChart"><h4>Causes externes de délais Interventions NFI</h4><h5>Nombre de causes reportées</h5></div>
									</div>
									<div  class="col-md-1">
									   
									</div>
						</div>	
						<div class="row">	  
									<div  class="col-md-1">
									   
									</div>
									<div  class="col-md-4">
									   <div Class ="CauseIntWASH" id="cccm" class="dc-lineChart"><h4>Cause internes de délais Interventions EAH</h4><h5>Nombre de causes reportées</h5></div>
									</div>
									<div  class="col-md-2">
									   
									</div>
								
									<div  class="col-md-4">
									   <div Class ="CauseExtWASH" id="cccm" class="dc-lineChart"><h4>Causes externes de délais Interventions EAH</h4><h5>Nombre de causes reportées</h5></div>
									</div>
									<div  class="col-md-1">
									   
									</div>
						</div>	-->
						
						<div class="row">
							<div  class="col-md-8">
							   <div Class ="start_dates" id="cccm" class="dc-lineChart">
								  <h4>Nombre d'interventions effectuées</h4><h5>Selectionner le graphique pour filtrer par date</h5>
								</div>
							</div>
							<!--<div  class="col-md-4">
								<div  class="year" id="cccm" class="dc-barChart">
								     <h4>Nombre d’interventions par an</h4>
								</div>
							</div>-->
						</div>
						<div class="row">
							<h5>*WASH: Eau, Hygiène et Assainissement; **NFI: Produits non-alimentaires</h5>	
							<h5>***CBS: Mélange maïs-soja; ****CG: Comité de gestion </h5>		</br></br>					
														
						</div>
					</div>
                </div>
            </div>
    </div>
      
   

    <script type="text/javascript" src="js/intro.js"></script>
    <script type="text/javascript" src="js/d3_002.js"></script>
    <script type="text/javascript" src="js/d3.js"></script>
    <script type="text/javascript" src="js/crossfilter.js"></script>
    <script type="text/javascript" src="js/dc.js"></script>
    <script type="text/javascript" src="js/jquery.js"></script>
<!--maps-->
    <script type="text/javascript" src="js/leaflet.js"></script>
	<script type="text/javascript"  src="js/esri-leaflet.js"></script>
    <script type="text/javascript" src="js/leaflet.markercluster.js"></script>
    <script type="text/javascript" src="js/dc.leaflet_inter.js"></script>
    <script type="text/javascript" src="js/colorbrewer.js"></script>

<script type="text/javascript">

/*     Markers      */

d3.csv("data/RRM_Interventions.csv", function(error,data) {
     //drawMarkerSelect(data);
	
     drawMarkerArea(data);
});


function regroup(dim, cols) {
    var _groupAll = dim.groupAll().reduce(
        function(p, v) { // add
            cols.forEach(function(c) {
                p[c] += v[c];
            });
            return p;
        },
        function(p, v) { // remove
            cols.forEach(function(c) {
                p[c] -= v[c];
            });
            return p;
        },
        function() { // init
            var p = {};
            cols.forEach(function(c) {
                p[c] = 0;
            });
            return p;
        });
    return {
        all: function() {
            // or _.pairs, anything to turn the object into an array
            return d3.map(_groupAll.value()).entries();
        }
    };
}

function drawMarkerArea(data) {
	var dateFormat = d3.time.format("%d.%m.%Y");
    data.forEach(function (d) {
	d.DD  = dateFormat.parse(d.endDate)
	//d.year = d3.time.year(d.DD)
	d.month= d3.time.month(d.DD)
	});

  var xf = crossfilter(data);
  var groupname = "marker-select";

  
   var facilities = xf.dimension(function(d) { return d.Latitude+","+d.Longitude; });
  var facilitiesGroup = facilities.group();
  
  dc.leafletMarkerChart(".map",groupname)
      .dimension(facilities)
      .group(facilitiesGroup)
      .width(900)
      //.height(300)
      .center([6.6,19.90])
      .zoom(6)
      .cluster(false)
      .renderPopup(true)
      .filterByArea(true)
      //.title(function (d) {return d.locationName + ": "+d.Individus_bénéficiaires_NFI_total+" individuals";})
    ;
  
		
		
		
		var PartnerDim = xf.dimension(function(d) { return d['Partner']; });
var Partnergp = PartnerDim.group().reduceCount();

  dc.rowChart("#cccm .partner",groupname)
        .dimension(PartnerDim)
        .group(Partnergp)
        .elasticX(true)
        .width(250)
        .height(200)
        .renderLabel(true)
        .ordering(function (p) { return -p.value;})
        .colors(['#FF6600'])
        .colorDomain([0,0])
        .colorAccessor(function(d, i){return 1;})
        .xAxis().ticks(4).tickFormat(d3.format(""));

		
	//********	
	var pref1 = xf.dimension(function(d) { return d.Code_Prefecture; });
	var nombre = pref1.group().reduceSum(function (d) { if (d.NFI_WASH == "NFI" )
			  return 1; else return 1; });
	 		  
	dc.rowChart("#cccm .nombre",groupname)
        .dimension(pref1)
        .group(nombre)
        .width(800)
		.height(40)
        .colors(['#FF6600'])
		.label(function(d) { return "Nombre total d'interventions: "+d.value; })
		.margins({top: 10, right: 5, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.2]));	 
			  
	//********		
		
  var interdim = xf.dimension(function(d) { 
			if (d.NFI_WASH == "NFI" )
			  return "NFI"  
			else if (d.NFI_WASH == "WASH" )
			  return "WASH"  
			else if (d.NFI_WASH == "NFI-WASH" )
			  return "NFI-WASH"	
			else
			  return "NFI-WASH"   			
			});   
  
  var intergp = interdim.group();  
  dc.rowChart("#cccm .intertype",groupname)
        .dimension(interdim)
        .group(intergp)
        .width(250)
        .height(200)
        .title(function (d) {return d.value+" interventions";})
		.colors(['#009933','#CC3333','#0066FF' ])
        .renderLabel(true)
		.xAxis().ticks(4).tickFormat(d3.format(""));
        ;
  
  var pref = xf.dimension(function(d) { return d.Code_Prefecture; });

  var natte = pref.group().reduceSum(function (d) { return d.NFI_nattes_total; });
  var bache = pref.group().reduceSum(function (d) { return d.NFI_baches_total; });
  var couverture = pref.group().reduceSum(function (d) { return d.NFI_couvertures_total; });
  var savon = pref.group().reduceSum(function (d) { return d.NFI_savons_total; });
  var bidon = pref.group().reduceSum(function (d) { return d.NFI_bidons_total; });
  var seau = pref.group().reduceSum(function (d) { return d.NFI_seau_total; });
  var kitcuis = pref.group().reduceSum(function (d) { return d.NFI_kitCuisine_total; });
  var vetenf = pref.group().reduceSum(function (d) { return d.NFI_vetements_enfants_total; });
  var vetbebe = pref.group().reduceSum(function (d) { return d.NFI_vetement_bebe; });
  var torche = pref.group().reduceSum(function (d) { return d.NFI_torche_total; });
  var moustiquaire = pref.group().reduceSum(function (d) { return d.NFI_moustiquaires_total; });

	
	dc.rowChart("#cccm .moustiquaire",groupname)
        .dimension(pref)
        .group(moustiquaire)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Moustiquaires: "+d.value+" unités"; })
		.margins({top: -0.2, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));  
	dc.rowChart("#cccm .seau",groupname)
        .dimension(pref)
        .group(seau)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Seaux: "+d.value+" unités"; })
		.margins({top: -0.2, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));  	
	dc.rowChart("#cccm .natte",groupname)
        .dimension(pref)
        .group(natte)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Natte: "+d.value+" unités"; })
		.margins({top: -0.2, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));  
	dc.rowChart("#cccm .bache",groupname)
        .dimension(pref)
        .group(bache)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Bâches: "+d.value+" unités"; })
		.margins({top: -1, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
    dc.rowChart("#cccm .couverture",groupname)
        .dimension(pref)
        .group(couverture)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Couverture: "+d.value+" unités"; })
		.margins({top: 0, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
	dc.rowChart("#cccm .savon",groupname)
        .dimension(pref)
        .group(savon)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Savons: "+d.value+" unités"; })
		.margins({top: 0, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
	dc.rowChart("#cccm .bidon",groupname)
        .dimension(pref)
        .group(bidon)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Bidons: "+d.value+" unités"; })
		.margins({top: 0, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
	dc.rowChart("#cccm .kitcuis",groupname)
        .dimension(pref)
        .group(kitcuis)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Kit cuisine: "+d.value+" kits"; })
		.margins({top: 0, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
	dc.rowChart("#cccm .vetenf",groupname)
        .dimension(pref)
        .group(vetenf)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Vêtements Enfant: "+d.value; })
		.margins({top: 0, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
	dc.rowChart("#cccm .vetbebe",groupname)
        .dimension(pref)
        .group(vetbebe)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Vêtements bébé: "+d.value; })
		.margins({top: 0, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1000]));
	dc.rowChart("#cccm .torche",groupname)
        .dimension(pref)
        .group(torche)
        .width(200)
        .height(30)
        .colors(['#009933'])
		.label(function(d) { return "Torche: "+d.value+" unités"; })
		.margins({top: 0, right: 10, bottom: 0, left: 30})
		.x(d3.scale.linear().domain([0, 1000]))
		;
	 
   

  	   
  
  var sensib = pref.group().reduceSum(function (d) { return d.Sensibilisation_communaute_lavage_main; });
  var comgest = pref.group().reduceSum(function (d) { return d.comite_gestion_latrines; });
    dc.rowChart("#cccm .comgest",groupname)
        .dimension(pref)
        .group(comgest)
        .width(250)
        .height(40)
        .colors(['#3182bd'])
		.label(function(d) { return "Com. Gestion assainissement: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.4]));
 
	  dc.rowChart("#cccm .sensib",groupname)
        .dimension(pref)
        .group(sensib)
        .width(250)
        .height(40)
        .colors(['#3182bd'])
		.label(function(d) { return "Lavage des mains: "+d.value; })
		.margins({top: 5, right: 10, bottom: 0, left: 30})
		.x(d3.scale.linear().domain([0, 0.4]));

  var latbloc = pref.group().reduceSum(function (d) { return d.Nb_blocs_latrines; });
  var lat = pref.group().reduceSum(function (d) { return d.nb_latrines_installees; });
  	
	  dc.rowChart("#cccm .latbloc",groupname)
        .dimension(pref)
        .group(latbloc)
        .width(250)
        .height(40)
        .colors(['#3333FF'])
		.label(function(d) { return "Construction blocs  de latrines: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 1]));
	  dc.rowChart("#cccm .lat",groupname)
        .dimension(pref)
        .group(lat)
        .width(250)
        .height(40)
        .colors(['#3333FF'])
		.label(function(d) { return "Construction de latrines: "+d.value; })
		.margins({top: 5, right: 10, bottom: 0, left: 30})
		.x(d3.scale.linear().domain([0, 1]));

	var borehole = pref.group().reduceSum(function (d) { return d.rehabilitation_forage_source_eau; });
	var gestion = pref.group().reduceSum(function (d) { return d.Redynamisation_comite_gestion_source_eau; });
    dc.rowChart("#cccm .borehole",groupname)
        .dimension(pref)
        .group(borehole)
        .width(250)
        .height(40)
        .colors(['#0099FF'])
		.label(function(d) { return "Réhabilitation forages: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.4]));
	 dc.rowChart("#cccm .gestion",groupname)
        .dimension(pref)
        .group(gestion)
        .width(250)
        .height(40)
        .colors(['#0099FF'])
		.label(function(d) { return "Formations Com. Gestion eau: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.4]));
  
	
	 var prefecture = xf.dimension(function(d) { return d.Prefecture; });
     var prefecturesect = prefecture.group().reduceCount();
  
	  dc.rowChart("#cccm .inter",groupname)
			.dimension(prefecture)
			.group(prefecturesect)
			.elasticX(true)
			.width(300)
			.height(300)
			.renderLabel(true)
			.colors(['#58585A'])
			.ordering(function (p) { return -p.value;})
			.colorDomain([0,0])
			.colorAccessor(function(d, i){return 1;})
			.xAxis().ticks(4).tickFormat(d3.format(""));
			
			// TOTAL_individus_beneficiaires
	
  var prefec = xf.dimension(function(d) { return d.Prefecture; });
  var pop_NFI = prefec.group().reduceSum(function (d) { return d.TOTAL_individus_beneficiaires_NFI; });
  var pop_WASH = prefec.group().reduceSum(function (d) { return d.TOTAL_individus_beneficiaires_WASH; });
  
  dc.rowChart("#cccm .prefWASH",groupname)
        .dimension(prefec)
        .group(pop_WASH)
		.elasticX(true)
        .width(300)
        .height(300)
		.elasticX(true)
        .renderLabel(true)
        .colors(['#3182bd'])
		.ordering(function (p) { return -p.value;})
        .xAxis().ticks(4).tickFormat(d3.format(""))
		
		;  
		
	dc.rowChart("#cccm .prefNFI",groupname)
        .dimension(prefec)
        .group(pop_NFI)
		.elasticX(true)
        .width(300)
        .height(300)
        .renderLabel(true)
		.ordering(function (p) { return -p.value;})
		.colors(["#31a354"])
        .xAxis().ticks(4).tickFormat(d3.format("s"));
		
		//***************
 

var yeargp  = xf.dimension(function(d) { return d.year; });
			
  var yeargroup = yeargp.group().reduceCount();

    dc.barChart("#cccm .year",groupname)
		.dimension(yeargp)
		.group(yeargroup)
		.width(300)
        .height(200)
		.x(d3.scale.ordinal().domain([2014,2015,2016,2017]))
		.xUnits(dc.units.ordinal)
		.transitionDuration(500)
		.centerBar(true)	
		.gap(30)  // 65 = norm
		.elasticY(true)
		.xAxisLabel('Année')
		.yAxisLabel('Nombre d’activités')
		.xAxis().tickFormat(function (d) {
        return d})
		;


var stdateDim = xf.dimension(function(d) {return d.month});
var stdategp = stdateDim.group();
var times = function(d) {return d.DD};

 dc.lineChart("#cccm .start_dates",groupname)
		.height(200)
		.width(700)
        .dimension(stdateDim)
		.group(stdategp)
		.x(d3.time.scale())
	    .round(d3.time.month.round)
	    .xUnits(d3.time.month)
	    .elasticY(true)
		.elasticX(true)
		.margins({top: 10, right: 10, bottom: 30, left: 30})
		.renderHorizontalGridLines(true)
		.renderArea(true)
		.dotRadius(8)
		
		.yAxisLabel('Nombre d’activités')
		.xAxis().ticks(12)
		;

$('#reset').on('click', function (){
  dc.filterAll(groupname);
  dc.redrawAll(groupname);
  return false;
})


  dc.renderAll(groupname);
}

</script>

 <script src="js/bootstrap.js"></script>
<!-- Custom Theme JavaScript -->
<script>
// Closes the sidebar menu
$("#menu-close").click(function(e) {
    e.preventDefault();
    $("#sidebar-wrapper").toggleClass("active");
});

// Opens the sidebar menu
$("#menu-toggle").click(function(e) {
    e.preventDefault();
    $("#sidebar-wrapper").toggleClass("active");
});

// Scrolls to the selected menu item on the page
$(function() {
    $('a[href*=#]:not([href=#])').click(function() {
        if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') || location.hostname == this.hostname) {

            var target = $(this.hash);
            target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
            if (target.length) {
                $('html,body').animate({
                    scrollTop: target.offset().top
                }, 1000);
                return false;
            }
        }
    });
});
</script>

</body>


</html>

